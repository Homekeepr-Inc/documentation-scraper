# Basic Squid config for proxying to Rayobyte
# Disable caching to keep it lightweight for scraping
cache deny all
# No local cache storage (0 size disables caching)
cache_dir /tmp 0 1 1

# Upstream proxy: Rayobyte with auth
# 'login' handles username:password for the parent proxy
cache_peer domain.com parent 8000 0 no-query login=username:password
# Force all requests through the upstream proxy (no direct connections)
never_direct allow all

# Access control: Allow only from the app_network (Docker bridge network)
# Assumes app_network subnet is 172.19.0.0/16 (based on logs; adjust if needed)
# This restricts to containers on the same network (e.g., app container only)
acl app_network src 172.19.0.0/16
http_access allow app_network
http_access deny all

# Listen on port 3128 (internal only)
http_port 3128

# Logging (for debugging; logs will be in container)
logfile_rotate 0
access_log stdio:/var/log/squid/access.log
cache_log stdio:/var/log/squid/cache.log